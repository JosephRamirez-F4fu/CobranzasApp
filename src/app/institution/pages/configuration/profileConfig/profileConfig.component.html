<section class="mx-auto flex max-w-4xl flex-col gap-8 p-6 md:p-8">
  <app-config-section title="Perfil de Usuario" maxWidthClass="w-full">
    @if (loading()) {
    <p class="text-sm font-medium text-slate-500">Cargando...</p>
    } @else {
    <form class="space-y-6" [formGroup]="form" (ngSubmit)="save()">
      <div class="grid gap-6 md:grid-cols-2">
        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-900">Nombre completo</label>
          <input
            type="text"
            formControlName="nombreCompleto"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 placeholder:text-slate-900 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          />
          @if(form.controls.nombreCompleto.invalid && form.controls.nombreCompleto.touched){
          <p class="text-xs font-medium text-rose-500">Requerido.</p>
          }
        </div>
        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-900">Correo</label>
          <input
            type="email"
            formControlName="correo"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 placeholder:text-slate-900 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          />
          @if(form.controls.correo.invalid && form.controls.correo.touched){
          <p class="text-xs font-medium text-rose-500">Correo invalido.</p>
          }
        </div>
      </div>

      <app-config-form-actions
        [editing]="editing()"
        [saving]="saving()"
        (edit)="enableEdit()"
        (cancel)="cancel()"
      />
    </form>
    }
  </app-config-section>

  <app-config-section title="Cambiar Contrasena" maxWidthClass="w-full">
    <form
      class="space-y-6"
      [formGroup]="formChangPassword"
      (ngSubmit)="changePassword()"
    >
      <div class="space-y-1">
        <label class="mb-1 block text-sm font-semibold text-slate-900">Contrasena Actual</label>
        <input
          type="password"
          formControlName="oldPassword"
          class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 placeholder:text-slate-900 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200"
          autocomplete="current-password"
        />
        @if(formChangPassword.controls.oldPassword.invalid && formChangPassword.controls.oldPassword.touched){
        <p class="text-xs font-medium text-rose-500">Requerido.</p>
        }
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-900">Nueva Contrasena</label>
          <input
            type="password"
            formControlName="newPassword"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 placeholder:text-slate-900 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200"
            autocomplete="new-password"
          />
          @if(formChangPassword.controls.newPassword.invalid && formChangPassword.controls.newPassword.touched){
          <p class="text-xs font-medium text-rose-500">
            La contrasena debe tener al menos 6 caracteres.
          </p>
          }
        </div>
        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-900"
            >Confirmar Nueva Contrasena</label
          >
          <input
            type="password"
            formControlName="confirmNewPassword"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 placeholder:text-slate-900 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200"
            autocomplete="new-password"
          />
          @if(formChangPassword.controls.confirmNewPassword.invalid && formChangPassword.controls.confirmNewPassword.touched){
          <p class="text-xs font-medium text-rose-500">Las contrasenas no coinciden.</p>
          }
        </div>
      </div>

      <div class="flex flex-wrap gap-3">
        <button
          type="submit"
          class="inline-flex items-center justify-center rounded-xl border border-emerald-600 bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:bg-emerald-700 focus:outline-none focus:ring-4 focus:ring-emerald-200 disabled:cursor-not-allowed disabled:opacity-60 disabled:shadow-none"
          [disabled]="changingPassword()"
        >
          @if(changingPassword()){ Cambiando... } @else { Cambiar Contrasena }
        </button>
      </div>
    </form>
  </app-config-section>
</section>
