<section class="mx-auto flex max-w-6xl flex-col gap-8 p-6 md:p-8">
  <app-config-section title="Notificaciones" maxWidthClass="w-full">
    @if (loading()) {
    <p class="text-sm font-medium text-slate-900">Cargando configuraci?n...</p>
    }

    <div class="mb-6 flex flex-wrap gap-3">
      @for (m of medios; track m) {
      <button
        type="button"
        (click)="selectMedio(m)"
        class="rounded-full border px-4 py-2 text-sm font-semibold transition focus:outline-none focus:ring-4 focus:ring-sky-200"
        [ngClass]="
          medioSeleccionado() === m
            ? 'border-sky-600 bg-sky-600 text-white shadow-lg shadow-sky-500/30'
            : 'border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50'
        "
      >
        {{ m }}
      </button>
      }
    </div>

    <form [formGroup]="form" (ngSubmit)="save()" class="space-y-6">
      <div class="grid gap-6 md:grid-cols-2">
        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">Medio</label>
          <input
            type="text"
            formControlName="medioEnvio"
            class="w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium text-slate-700 shadow-sm"
            readonly
          />
        </div>

        <div class="mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-slate-50/60 px-4 py-3 md:mt-0">
          <input
            id="activo"
            type="checkbox"
            formControlName="activo"
            class="h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"
          />
          <label for="activo" class="text-sm font-semibold text-slate-700">Habilitado</label>
        </div>

        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">Frecuencia</label>
          <input
            type="text"
            formControlName="frecuencia"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          />
          @if(form.controls.frecuencia.invalid && form.controls.frecuencia.touched){
          <p class="text-xs font-medium text-rose-500">Requerido.</p>
          }
        </div>

        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">D?a del mes</label>
          <input
            type="number"
            formControlName="diadDelMes"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
            min="1"
            max="31"
          />
        </div>

        <div class="space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">Hora de env?o</label>
          <input
            type="time"
            formControlName="horaEnvio"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          />
          @if(form.controls.horaEnvio.invalid && form.controls.horaEnvio.touched){
          <p class="text-xs font-medium text-rose-500">Requerido.</p>
          }
        </div>

        <div class="md:col-span-2 space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">Mensaje</label>
          <textarea
            rows="4"
            formControlName="mensaje"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          ></textarea>
          @if(form.controls.mensaje.invalid && form.controls.mensaje.touched){
          <p class="text-xs font-medium text-rose-500">M?nimo 3 caracteres.</p>
          }
        </div>

        @if(medioSeleccionado() === emailMedio){
        <div class="md:col-span-2 space-y-1">
          <label class="mb-1 block text-sm font-semibold text-slate-700">Asunto (Email)</label>
          <input
            type="text"
            formControlName="asunto"
            class="w-full rounded-xl border border-slate-300 bg-white/90 px-4 py-3 text-sm font-medium text-slate-800 shadow-sm transition focus:border-sky-500 focus:outline-none focus:ring-4 focus:ring-sky-200 disabled:cursor-not-allowed disabled:bg-slate-100 disabled:text-slate-400"
          />
          @if(form.controls.asunto.invalid && form.controls.asunto.touched){
          <p class="text-xs font-medium text-rose-500">Requerido.</p>
          }
        </div>
        }
      </div>

      <app-config-form-actions
        [editing]="editing()"
        [saving]="saving()"
        [disableSave]="form.invalid"
        (edit)="enableEdit()"
        (cancel)="cancel()"
      />
    </form>
  </app-config-section>
</section>
